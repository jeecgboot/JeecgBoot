<div class="layui-form" action="">

    <div class="layui-form-item" >
        <label class="layui-form-label">后台账号</label>
        <div class="layui-input-block">
            <input type="hidden" id="id" name="id">
            <input type="hidden" id="type" name="type" value="epay">
            <input type="text" id="user" lay-verify="required" autocomplete="off" class="layui-input" readonly>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">商户ID</label>
        <div class="layui-input-block">
            <input type="number" id="appId" lay-verify="required" placeholder="请输入商户ID" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">appKey</label>
        <div class="layui-input-block">
            <input type="text" id="appKey" lay-verify="required" placeholder="请输入密钥" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">通知邮箱</label>
        <div class="layui-input-block">
            <input type="email" id="email" lay-verify="required" placeholder="请输入通知邮箱" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">支付网关</label>
        <div class="layui-input-block">
            <input type="email" id="createUrl" lay-verify="required" placeholder="请输入支付网关" autocomplete="off" class="layui-input">
        </div>
    </div>


    <div class="layui-form-item">
        <label class="layui-form-label">异步通知地址</label>
        <div class="layui-input-block">
            <input type="text" id="notifyUrl" lay-verify="required" placeholder="请输入通知地址" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">同步通知地址</label>
        <div class="layui-input-block">
            <input type="text" id="returnUrl" lay-verify="required" placeholder="请输入通知地址" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item" style="text-align: right; display: block">
        <button class="layui-btn" onclick="save()">保存</button>
    </div>

</div>

<style>
    .layui-form-item {
        display: flex;
    }
    .layui-form-label {
        width: 120px;
    }
    .layui-input-block {
        margin-left: 20px;
        width: 500px;
        display: flex;
    }
</style>
<script>
    var useLocalUser = false;
    $(".useLocalUser").hide();
    if (useLocalUser) {
        $(".useLocalUser").show();
    }

    layui.use(['form','layer','upload'], function(){
        var table = layui.table,form = layui.form,upload = layui.upload;
        form.render();

    });

    function save() {
        var id = $("#id").val();
        var user = $("#user").val();
        var type = $("#type").val();
        var email = $("#email").val();
        var appId = $("#appId").val();
        var appKey = $("#appKey").val();
        var createUrl = $("#createUrl").val();
        var notifyUrl = $("#notifyUrl").val();
        var returnUrl = $("#returnUrl").val();
        if (user == ""){
            layer.msg("请输入管理员账号");
            return;
        }
        if (appId == ""){
            layer.msg("请输入商户ID");
            return;
        }
        if (appKey == ""){
            layer.msg("请输入appKey");
            return;
        }
        if (createUrl == ""){
            layer.msg("请输入支付网关");
            return;
        }
        if (notifyUrl == ""){
            layer.msg("请输入通知地址");
            return;
        }

        $.ajax({
            type: 'POST',
            url: "admin/saveOtherSetting?type=epay",
            contentType: "application/json",
            async: false,
            data: JSON.stringify( { 'id':id ,'username':user ,'type':type,'email':email,'appId':appId,'appKey':appKey, 'notifyUrl':notifyUrl ,'returnUrl':returnUrl,'createUrl':createUrl} ),
            datatype: "json",
            success: function (data) {
                if (data.code==1){
                    getSettings();
                }
                layer.msg(data.msg);
            }
        });
    }

    function getSettings() {
        $.post("admin/getOtherSettings?type=epay",function (data) {
            if (data.code==1){
                $("#id").val(data.data.id);
                $("#user").val(data.data.username);
                $("#email").val(data.data.email);
                $("#notifyUrl").val(data.data.notifyUrl);
                $("#returnUrl").val(data.data.returnUrl);
                $("#createUrl").val(data.data.createUrl);
                $("#appId").val(data.data.appId);
                $("#appKey").val(data.data.appKey);
                layui.form.render();
            }
        });
    }
    getSettings();
</script>