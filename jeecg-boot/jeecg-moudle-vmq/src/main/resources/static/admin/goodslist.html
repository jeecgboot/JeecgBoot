<div class="layui-form layui-form-pane" action="">
<div class="layui-form-item">
    <div class="layui-inline">
        <label class="layui-form-label">商品名称</label>
        <div class="layui-input-inline">
            <input type="text" id="name" name="name" class="layui-input">
        </div>
    </div>
</div>
</div>

<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="add" style="background-color: cornflowerblue;">新增商品</button>
    </div>
</script>
<table id="demo" lay-filter="test"></table>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="del">删除</a>
</script>

<script>

    var myTable,table,form;

    function creatGoods(name, memo, price, number) {
        layer.msg("功能开发中");
    }

    layui.use(['form','table','laydate'], function(){
        table = layui.table;
        form = layui.form;

        //第一个实例
        myTable = table.render({
            elem: '#demo'
            ,height: 'full-160'
            ,url: '/admin/getGoods'
            ,toolbar: '#toolbarDemo'
            ,where: {
                state:$("#state").val(),
                type:$("#type").val()
            }
            ,cols: [[ //表头
                {field: 'name', title: '名称',minWidth:150},
                {field: 'memo', title: '描述',minWidth:180},
                {field: 'picture', title: '图片',minWidth:180},
                {field: 'price', title: '价格',minWidth:80, align:'center'},
                {field: 'number', title: '数量',minWidth:80, align:'center'},
                {field: 'createDate', title: '创建时间',minWidth:160,templet: function(d){
                        return formatDate(d.createDate);
                    }
                },
                {title: '操作', minWidth: 120, align:'center', toolbar: '#barDemo'}
            ]]
            ,page:true
        });

        //监听行工具事件
        table.on('tool(test)', function(obj){ //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
            var data = obj.data //获得当前行数据
                ,layEvent = obj.event; //获得 lay-event 对应的值
            if(layEvent === 'edit'){
                layer.msg("功能开发中");
            }else if(layEvent === 'del'){
                layer.msg("功能开发中");
            }
        });

        //头工具栏事件
        table.on('toolbar(test)', function(obj){
            var id = new Date().getTime();
            switch(obj.event){
                case 'add':
                    layer.confirm("<div style='line-height: 40px;'><p>名称：<input type='text' id='name' name='name' /></p><p>描述：<input id='memo' name='memo' type='text' /></p>" +
                        "<p>价格：<input id='price' name='price' value='1' /></p><p>数量：<input id='number' name='number' value='100' /></p></div>",function () {
                        layer.msg('操作中');
                        var name = $("#name").val();
                        var memo = $("#memo").val();
                        var price = $("#price").val();
                        var number = $("#number").val();
                        var code = creatGoods(name,memo,price,number);
                        if (code==1){
                            myTable.reload({
                                where: {
                                    state:$("#state").val(),
                                    type:$("#type").val()
                                }
                            });
                        }
                    });
                    break;
            };
        });
        form.render();
    });
</script>
