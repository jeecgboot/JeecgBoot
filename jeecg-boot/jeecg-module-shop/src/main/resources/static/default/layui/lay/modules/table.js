layui.define(["laytpl","laypage","layer","form","util"],function(ap){var ab=layui.$,al=layui.laytpl,au=layui.laypage,ai=layui.layer,ag=layui.form,af=(layui.util,layui.hint()),ad=layui.device(),aq={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?layui.table.index+10000:0,set:function(b){var a=this;return a.config=ab.extend({},a.config,b),a},on:function(b,a){return layui.onevent.call(this,V,b,a)}},ar=function(){var c=this,b=c.config,a=b.id||b.index;return a&&(ar.that[a]=c,ar.config[a]=b),{config:b,reload:function(d){c.reload.call(c,d)},setColsWidth:function(){c.setColsWidth.call(c)},resize:function(){c.resize.call(c)}}},ac=function(b){var a=ar.config[b];return a||af.error("The ID option was not found in the table instance"),a||null},aa=function(d,c,b,g){var f=d.templet?function(){return"function"==typeof d.templet?d.templet(b):al(ab(d.templet).html()||String(c)).render(b)}():c;return g?ab("<div>"+f+"</div>").text():f},V="table",am=".layui-table",ao="layui-hide",ae="layui-none",Z="layui-table-view",ah=".layui-table-tool",an=".layui-table-box",at=".layui-table-init",X=".layui-table-header",aj=".layui-table-body",P=".layui-table-main",Y=".layui-table-fixed",B=".layui-table-fixed-l",Q=".layui-table-fixed-r",J=".layui-table-total",I=".layui-table-page",D=".layui-table-sort",G="layui-table-edit",q="layui-table-hover",av=function(b){var a='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';return b=b||{},['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){return b.fixed&&"right"!==b.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===b.fixed?'{{# if(item2.fixed === "right"){ }}':""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+a+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",b.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},O=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),U=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',av(),"</div>",'<div class="layui-table-body layui-table-main">',O,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',av({fixed:!0}),"</div>",'<div class="layui-table-body">',O,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',av({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',O,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),K=ab(window),ak=ab(document),M=function(b){var a=this;a.index=++aq.index,a.config=ab.extend({},a.config,aq.config,b),a.render()};M.prototype.config={limit:10,loading:!0,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:!0,text:{none:'<div class="ew-state-group" style="padding: 25px 0 35px 0;">                    <img src="/default/images/error_ic_empty.png" style="height: 90px;">                    <p>没有相关订单信息</p>                </div>'}},M.prototype.render=function(){var f=this,c=f.config;if(c.elem=ab(c.elem),c.where=c.where||{},c.id=c.id||c.elem.attr("id")||f.index,c.request=ab.extend({pageName:"page",limitName:"limit"},c.request),c.response=ab.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",totalRowName:"totalRow",countName:"count"},c.response),"object"==typeof c.page&&(c.limit=c.page.limit||c.limit,c.limits=c.page.limits||c.limits,f.page=c.page.curr=c.page.curr||1,delete c.page.elem,delete c.page.jump),!c.elem[0]){return f}c.height&&/^full-\d+$/.test(c.height)&&(f.fullHeightGap=c.height.split("-")[1],c.height=K.height()-f.fullHeightGap),f.setInit();var b=c.elem,h=b.next("."+Z),g=f.elem=ab(al(U).render({VIEW_CLASS:Z,data:c,index:f.index}));if(c.index=f.index,f.key=c.id||c.index,h[0]&&h.remove(),b.after(g),f.layTool=g.find(ah),f.layBox=g.find(an),f.layHeader=g.find(X),f.layMain=g.find(P),f.layBody=g.find(aj),f.layFixed=g.find(Y),f.layFixLeft=g.find(B),f.layFixRight=g.find(Q),f.layTotal=g.find(J),f.layPage=g.find(I),f.renderToolbar(),f.fullSize(),c.cols.length>1){var d=f.layFixed.find(X).find("th");d.height(f.layHeader.height()-1-parseFloat(d.css("padding-top"))-parseFloat(d.css("padding-bottom")))}f.pullData(f.page),f.events()},M.prototype.initOpts=function(c){var b=this,a=(b.config,{checkbox:48,radio:48,space:15,numbers:40});c.checkbox&&(c.type="checkbox"),c.space&&(c.type="space"),c.type||(c.type="normal"),"normal"!==c.type&&(c.unresize=!0,c.width=c.width||a[c.type])},M.prototype.setInit=function(c){var b=this,a=b.config;return a.clientWidth=a.width||function(){var d=function(g){var f,e;g=g||a.elem.parent(),f=g.width();try{e="none"===g.css("display")}catch(h){}return !g[0]||f&&!e?f:d(g.parent())};return d()}(),"width"===c?a.clientWidth:void layui.each(a.cols,function(f,d){layui.each(d,function(e,h){if(!h){return void d.splice(e,1)}if(h.key=f+"-"+e,h.hide=h.hide||!1,h.colGroup||h.colspan>1){var g=0;layui.each(a.cols[f+1],function(k,j){j.HAS_PARENT||g>1&&g==h.colspan||(j.HAS_PARENT=!0,j.parentKey=f+"-"+e,g+=parseInt(j.colspan>1?j.colspan:1))}),h.colGroup=!0}b.initOpts(h)})})},M.prototype.renderToolbar=function(){var g=this,c=g.config,b=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),j=g.layTool.find(".layui-table-tool-temp");if("default"===c.toolbar){j.html(b)}else{if("string"==typeof c.toolbar){var i=ab(c.toolbar).html()||"";i&&j.html(al(i).render(c))}}var f={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},h=[];"object"==typeof c.defaultToolbar&&layui.each(c.defaultToolbar,function(k,d){var a="string"==typeof d?f[d]:d;a&&h.push('<div class="layui-inline" title="'+a.title+'" lay-event="'+a.layEvent+'"><i class="layui-icon '+a.icon+'"></i></div>')}),g.layTool.find(".layui-table-tool-self").html(h.join(""))},M.prototype.setParentCol=function(j,p){var h=this,m=h.config,g=h.layHeader.find('th[data-key="'+m.index+"-"+p+'"]'),f=parseInt(g.attr("colspan"))||0;if(g[0]){var c=p.split("-"),b=m.cols[c[0]][c[1]];j?f--:f++,g.attr("colspan",f),g[f<1?"addClass":"removeClass"](ao),b.colspan=f,b.hide=f<1;var k=g.data("parentkey");k&&h.setParentCol(j,k)}},M.prototype.setColsPatch=function(){var b=this,a=b.config;layui.each(a.cols,function(d,c){layui.each(c,function(f,e){e.hide&&b.setParentCol(e.hide,e.parentKey)})})},M.prototype.setColsWidth=function(){var k=this,x=k.config,j=0,v=0,h=0,g=0,f=k.setInit("width");k.eachCols(function(c,a){a.hide||j++}),f=f-function(){return"line"===x.skin||"nob"===x.skin?2:j+1}()-k.getScrollWidth(k.layMain[0])-1;var b=function(a){layui.each(x.cols,function(c,d){layui.each(d,function(e,n){var o=0,l=n.minWidth||x.cellMinWidth;return n?void (n.colGroup||n.hide||(a?h&&h<l&&(v--,o=l):(o=n.width||0,/\d+%$/.test(o)?(o=Math.floor(parseFloat(o)/100*f),o<l&&(o=l)):o||(n.width=o=0,v++)),n.hide&&(o=0),g+=o)):void d.splice(e,1)})}),f>g&&v&&(h=(f-g)/v)};b(),b(!0),k.autoColNums=v,k.eachCols(function(d,c){var e=c.minWidth||x.cellMinWidth;c.colGroup||c.hide||(0===c.width?k.getCssRule(x.index+"-"+c.key,function(a){a.style.width=Math.floor(h>=e?h:e)+"px"}):/\d+%$/.test(c.width)&&k.getCssRule(x.index+"-"+c.key,function(a){a.style.width=Math.floor(parseFloat(c.width)/100*f)+"px"}))});var m=k.layMain.width()-k.getScrollWidth(k.layMain[0])-k.layMain.children("table").outerWidth();if(k.autoColNums&&m>=-j&&m<=j){var p=function(c){var a;return c=c||k.layHeader.eq(0).find("thead th:last-child"),a=c.data("field"),!a&&c.prev()[0]?p(c.prev()):c},y=p(),w=y.data("key");k.getCssRule(w,function(c){var a=c.style.width||y.outerWidth();c.style.width=parseFloat(a)+m+"px",k.layMain.height()-k.layMain.prop("clientHeight")>0&&(c.style.width=parseFloat(c.style.width)-1+"px")})}k.loading(!0)},M.prototype.resize=function(){var a=this;a.fullSize(),a.setColsWidth(),a.scrollPatch()},M.prototype.reload=function(b){var a=this;b=b||{},delete a.haveInit,b.data&&b.data.constructor===Array&&delete a.config.data,a.config=ab.extend(!0,{},a.config,b),a.render()},M.prototype.errorView=function(f){var d=this,c=d.layMain.find("."+ae),b=ab('<div class="'+ae+'">'+(f||"Error")+"</div>");c[0]&&(d.layNone.remove(),c.remove()),d.layFixed.addClass(ao),d.layMain.find("tbody").html(""),d.layMain.append(d.layNone=b),aq.cache[d.key]=[]},M.prototype.page=1,M.prototype.pullData=function(k){var j=this,t=j.config,h=t.request,g=t.response,f=function(){"object"==typeof t.initSort&&j.sort(t.initSort.field,t.initSort.type)};if(j.startTime=(new Date).getTime(),t.url){var b={};b[h.pageName]=k,b[h.limitName]=t.limit;var m=ab.extend(b,t.where);t.contentType&&0==t.contentType.indexOf("application/json")&&(m=JSON.stringify(m)),j.loading(),ab.ajax({type:t.method||"get",url:t.url,contentType:t.contentType,data:m,dataType:"json",headers:t.headers||{},success:function(a){"function"==typeof t.parseData&&(a=t.parseData(a)||a),a[g.statusName]!=g.statusCode?(j.renderForm(),j.errorView(a[g.msgName]||'返回的数据不符合规范，正确的成功状态码应为："'+g.statusName+'": '+g.statusCode)):(j.renderData(a,k,a[g.countName]),f(),t.time=(new Date).getTime()-j.startTime+" ms"),j.setColsWidth(),"function"==typeof t.done&&t.done(a,k,a[g.countName])},error:function(c,a){j.errorView("数据接口请求异常："+a),j.renderForm(),j.setColsWidth()}})}else{if(t.data&&t.data.constructor===Array){var p={},u=k*t.limit-t.limit;p[g.dataName]=t.data.concat().splice(u,t.limit),p[g.countName]=t.data.length,"object"==typeof t.totalRow&&(p[g.totalRowName]=ab.extend({},t.totalRow)),j.renderData(p,k,p[g.countName]),f(),j.setColsWidth(),"function"==typeof t.done&&t.done(p,k,p[g.countName])}}},M.prototype.eachCols=function(b){var a=this;return aq.eachCols(null,b,a.config.cols),a},M.prototype.renderData=function(l,f,d,a){var p=this,x=p.config,u=l[x.response.dataName]||[],j=l[x.response.totalRowName],w=[],i=[],k=[],t=function(){var b;return !a&&p.sortKey?p.sort(p.sortKey.field,p.sortKey.sort,!0):(layui.each(u,function(e,c){var n=[],r=[],g=[],m=e+x.limit*(f-1)+1;0!==c.length&&(a||(c[aq.config.indexName]=e),p.eachCols(function(A,y){var z=y.field||A,o=x.index+"-"+y.key,h=c[z];if(void 0!==h&&null!==h||(h=""),!y.colGroup){var s=['<td data-field="'+z+'" data-key="'+o+'" '+function(){var v=[];return y.edit&&v.push('data-edit="'+y.edit+'"'),y.align&&v.push('align="'+y.align+'"'),y.templet&&v.push('data-content="'+h+'"'),y.toolbar&&v.push('data-off="true"'),y.event&&v.push('lay-event="'+y.event+'"'),y.style&&v.push('style="'+y.style+'"'),y.minWidth&&v.push('data-minwidth="'+y.minWidth+'"'),v.join(" ")}()+' class="'+function(){var v=[];return y.hide&&v.push(ao),y.field||v.push("layui-table-col-special"),v.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return"normal"===y.type?o:o+" laytable-cell-"+y.type}()+'">'+function(){var C=ab.extend(!0,{LAY_INDEX:m},c),v=aq.config.checkName;switch(y.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){return y[v]?(c[v]=y[v],y[v]?"checked":""):C[v]?"checked":""}()+">";case"radio":return C[v]&&(b=e),'<input type="radio" name="layTableRadio_'+x.index+'" '+(C[v]?"checked":"")+' lay-type="layTableRadio">';case"numbers":return m}return y.toolbar?al(ab(y.toolbar).html()||"").render(C):aa(y,h,C)}(),"</div></td>"].join("");n.push(s),y.fixed&&"right"!==y.fixed&&r.push(s),"right"===y.fixed&&g.push(s)}}),w.push('<tr data-index="'+e+'">'+n.join("")+"</tr>"),i.push('<tr data-index="'+e+'">'+r.join("")+"</tr>"),k.push('<tr data-index="'+e+'">'+g.join("")+"</tr>"))}),p.layBody.scrollTop(0),p.layMain.find("."+ae).remove(),p.layMain.find("tbody").html(w.join("")),p.layFixLeft.find("tbody").html(i.join("")),p.layFixRight.find("tbody").html(k.join("")),p.renderForm(),"number"==typeof b&&p.setThisRowChecked(b),p.syncCheckAll(),p.haveInit?p.scrollPatch():setTimeout(function(){p.scrollPatch()},50),p.haveInit=!0,ai.close(p.tipsIndex),x.HAS_SET_COLS_PATCH||p.setColsPatch(),void (x.HAS_SET_COLS_PATCH=!0))};return aq.cache[p.key]=u,p.layPage[0==d||0===u.length&&1==f?"addClass":"removeClass"](ao),a?t():0===u.length?(p.renderForm(),p.errorView(x.text.none)):(p.layFixed.removeClass(ao),t(),p.renderTotal(u,j),void (x.page&&(x.page=ab.extend({elem:"layui-table-page"+x.index,count:d,limit:x.limit,limits:x.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(c,b){b||(p.page=c.curr,x.limit=c.limit,p.pullData(c.curr))}},x.page),x.page.count=d,au.render(x.page))))},M.prototype.renderTotal=function(g,f){var d=this,c=d.config,b={};if(c.totalRow){layui.each(g,function(i,a){0!==a.length&&d.eachCols(function(l,k){var j=k.field||l,m=a[j];k.totalRow&&(b[j]=(b[j]||0)+(parseFloat(m)||0))})}),d.dataTotal={};var h=[];d.eachCols(function(i,k){var a=k.field||i,j=function(){var o=k.totalRowText||"",n=parseFloat(b[a]).toFixed(2),m={};return m[a]=n,n=aa(k,n,m),f?f[k.field]||o:k.totalRow?n||o:o}(),l=['<td data-field="'+a+'" data-key="'+c.index+"-"+k.key+'" '+function(){var m=[];return k.align&&m.push('align="'+k.align+'"'),k.style&&m.push('style="'+k.style+'"'),k.minWidth&&m.push('data-minwidth="'+k.minWidth+'"'),m.join(" ")}()+' class="'+function(){var m=[];return k.hide&&m.push(ao),k.field||m.push("layui-table-col-special"),m.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var m=c.index+"-"+k.key;return"normal"===k.type?m:m+" laytable-cell-"+k.type}()+'">'+j,"</div></td>"].join("");k.field&&(d.dataTotal[a]=j),h.push(l)}),d.layTotal.find("tbody").html("<tr>"+h.join("")+"</tr>")}},M.prototype.getColElem=function(f,d){var c=this,b=c.config;return f.eq(0).find(".laytable-cell-"+(b.index+"-"+d)+":eq(0)")},M.prototype.renderForm=function(a){ag.render(a,"LAY-table-"+this.index)},M.prototype.setThisRowChecked=function(f){var d=this,c=(d.config,"layui-table-click"),b=d.layBody.find('tr[data-index="'+f+'"]');b.addClass(c).siblings("tr").removeClass(c)},M.prototype.sort=function(x,o,z,k){var g,b,y=this,E={},C=y.config,t=C.elem.attr("lay-filter"),w=aq.cache[y.key];"string"==typeof x&&y.layHeader.find("th").each(function(f,e){var c=ab(this),h=c.data("field");if(h===x){return x=c,g=h,!1}});try{var g=g||x.data("field"),d=x.data("key");if(y.sortKey&&!z&&g===y.sortKey.field&&o===y.sortKey.sort){return}var A=y.layHeader.find("th .laytable-cell-"+d).find(D);y.layHeader.find("th").find(D).removeAttr("lay-sort"),A.attr("lay-sort",o||null),y.layFixed.find("th")}catch(j){return af.error("Table modules: Did not match to field")}y.sortKey={field:g,sort:o},C.autoSort&&("asc"===o?b=layui.sort(w,g):"desc"===o?b=layui.sort(w,g,!0):(b=layui.sort(w,aq.config.indexName),delete y.sortKey)),E[C.response.dataName]=b||w,y.renderData(E,y.page,y.count,!0),k&&layui.event.call(x,V,"sort("+t+")",{field:g,type:o})},M.prototype.loading=function(d){var c=this,b=c.config;b.loading&&(d?(c.layInit&&c.layInit.remove(),delete c.layInit,c.layBox.find(at).remove()):(c.layInit=ab(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i>',"</div>"].join("")),c.layBox.append(c.layInit)))},M.prototype.setCheckData=function(g,f){var d=this,c=d.config,b=aq.cache[d.key];b[g]&&b[g].constructor!==Array&&(b[g][c.checkName]=f)},M.prototype.syncCheckAll=function(){var f=this,d=f.config,c=f.layHeader.find('input[name="layTableCheckbox"]'),b=function(a){return f.eachCols(function(h,g){"checkbox"===g.type&&(g[d.checkName]=a)}),a};c[0]&&(aq.checkStatus(f.key).isAll?(c[0].checked||(c.prop("checked",!0),f.renderForm("checkbox")),b(!0)):(c[0].checked&&(c.prop("checked",!1),f.renderForm("checkbox")),b(!1)))},M.prototype.getCssRule=function(g,f){var d=this,c=d.elem.find("style")[0],b=c.sheet||c.styleSheet||{},h=b.cssRules||b.rules;layui.each(h,function(j,e){if(e.selectorText===".laytable-cell-"+g){return f(e),!0}})},M.prototype.fullSize=function(){var f,d=this,c=d.config,b=c.height;d.fullHeightGap&&(b=K.height()-d.fullHeightGap,b<135&&(b=135),d.elem.css("height",b)),b&&(f=parseFloat(b)-(d.layHeader.outerHeight()||38),c.toolbar&&(f-=d.layTool.outerHeight()||50),c.totalRow&&(f-=d.layTotal.outerHeight()||40),c.page&&(f-=d.layPage.outerHeight()||41),d.layMain.css("height",f-2))},M.prototype.getScrollWidth=function(b){var a=0;return b?a=b.offsetWidth-b.clientWidth:(b=document.createElement("div"),b.style.width="100px",b.style.height="100px",b.style.overflowY="scroll",document.body.appendChild(b),a=b.offsetWidth-b.clientWidth,document.body.removeChild(b)),a},M.prototype.scrollPatch=function(){var h=this,f=h.layMain.children("table"),c=h.layMain.width()-h.layMain.prop("clientWidth"),b=h.layMain.height()-h.layMain.prop("clientHeight"),m=(h.getScrollWidth(h.layMain[0]),f.outerWidth()-h.layMain.width()),k=function(d){if(c&&b){if(d=d.eq(0),!d.find(".layui-table-patch")[0]){var a=ab('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');a.find("div").css({width:c}),d.find("tr").append(a)}}else{d.find(".layui-table-patch").remove()}};k(h.layHeader),k(h.layTotal);var g=h.layMain.height(),j=g-b;h.layFixed.find(aj).css("height",f.height()>=j?j:"auto"),h.layFixRight[m>0?"removeClass":"addClass"](ao),h.layFixRight.css("right",c-1)},M.prototype.events=function(){var r,k=this,w=k.config,f=ab("body"),t={},y=k.layHeader.find("th"),l=".layui-table-cell",d=w.elem.attr("lay-filter");k.layTool.on("click","*[lay-event]",function(m){var p=ab(this),z=p.attr("lay-event"),i=function(h){var c=ab(h.list),o=ab('<ul class="layui-table-tool-panel"></ul>');o.html(c),w.height&&o.css("max-height",w.height-(k.layTool.outerHeight()||50)),p.find(".layui-table-tool-panel")[0]||p.append(o),k.renderForm(),o.on("click",function(s){layui.stope(s)}),h.done&&h.done(o,c)};switch(layui.stope(m),ak.trigger("table.tool.panel.remove"),ai.close(k.tipsIndex),z){case"LAYTABLE_COLS":i({list:function(){var c=[];return k.eachCols(function(h,e){e.field&&"normal"==e.type&&c.push('<li><input type="checkbox" name="'+e.field+'" data-key="'+e.key+'" data-parentkey="'+(e.parentKey||"")+'" lay-skin="primary" '+(e.hide?"":"checked")+' title="'+(e.title||e.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}),c.join("")}(),done:function(){ag.on("checkbox(LAY_TABLE_TOOL_COLS)",function(s){var c=ab(s.elem),A=this.checked,v=c.data("key"),h=c.data("parentkey");layui.each(w.cols,function(C,o){layui.each(o,function(E,e){if(C+"-"+E===v){var F=e.hide;e.hide=!A,k.elem.find('*[data-key="'+w.index+"-"+v+'"]')[A?"removeClass":"addClass"](ao),F!=e.hide&&k.setParentCol(!A,h),k.resize()}})})})}});break;case"LAYTABLE_EXPORT":ad.ie?ai.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3}):i({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(h,c){c.on("click",function(){var o=ab(this).data("type");aq.exportFile.call(k,w.id,null,o)})}});break;case"LAYTABLE_PRINT":var b=window.open("打印窗口","_blank"),g=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),a=ab(k.layHeader.html());a.append(k.layMain.find("table").html()),a.append(k.layTotal.find("table").html()),a.find("th.layui-table-patch").remove(),a.find(".layui-table-col-special").remove(),b.document.write(g+a.prop("outerHTML")),b.document.close(),b.print(),b.close()}layui.event.call(this,V,"toolbar("+d+")",ab.extend({event:z,config:w},{}))}),y.on("mousemove",function(h){var g=ab(this),c=g.offset().left,b=h.clientX-c;g.data("unresize")||t.resizeStart||(t.allowResize=g.width()-b<=10,f.css("cursor",t.allowResize?"col-resize":""))}).on("mouseleave",function(){ab(this);t.resizeStart||f.css("cursor","")}).on("mousedown",function(b){var a=ab(this);if(t.allowResize){var c=a.data("key");b.preventDefault(),t.resizeStart=!0,t.offset=[b.clientX,b.clientY],k.getCssRule(c,function(h){var g=h.style.width||a.outerWidth();t.rule=h,t.ruleWidth=parseFloat(g),t.minWidth=a.data("minwidth")||w.cellMinWidth})}}),ak.on("mousemove",function(c){if(t.resizeStart){if(c.preventDefault(),t.rule){var b=t.ruleWidth+c.clientX-t.offset[0];b<t.minWidth&&(b=t.minWidth),t.rule.style.width=b+"px",ai.close(k.tipsIndex)}r=1}}).on("mouseup",function(a){t.resizeStart&&(t={},f.css("cursor",""),k.scrollPatch()),2===r&&(r=null)}),y.on("click",function(c){var b,h=ab(this),g=h.find(D),e=g.attr("lay-sort");return g[0]&&1!==r?(b="asc"===e?"desc":"desc"===e?null:"asc",void k.sort(h,b,null,!0)):r=2}).find(D+" .layui-edge ").on("click",function(g){var c=ab(this),b=c.index(),h=c.parents("th").eq(0).data("field");layui.stope(g),0===b?k.sort(h,"asc",null,!0):k.sort(h,"desc",null,!0)});var x=function(g){var c=ab(this),b=c.parents("tr").eq(0).data("index"),i=k.layBody.find('tr[data-index="'+b+'"]'),h=aq.cache[k.key]||[];return h=h[b]||{},ab.extend({tr:i,data:aq.clearCacheKey(h),del:function(){aq.cache[k.key][b]=[],i.remove(),k.scrollPatch()},update:function(a){a=a||{},layui.each(a,function(s,p){if(s in h){var o,m=i.children('td[data-field="'+s+'"]');h[s]=p,k.eachCols(function(v,e){e.field==s&&e.templet&&(o=e.templet)}),m.children(l).html(aa({templet:o},p,h)),m.data("content",p)}})}},g)};k.elem.on("click",'input[name="layTableCheckbox"]+',function(){var g=ab(this).prev(),c=k.layBody.find('input[name="layTableCheckbox"]'),b=g.parents("tr").eq(0).data("index"),i=g[0].checked,h="layTableAllChoose"===g.attr("lay-filter");h?(c.each(function(m,a){a.checked=i,k.setCheckData(m,i)}),k.syncCheckAll(),k.renderForm("checkbox")):(k.setCheckData(b,i),k.syncCheckAll()),layui.event.call(g[0],V,"checkbox("+d+")",x.call(g[0],{checked:i,type:h?"all":"one"}))}),k.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var g=ab(this).prev(),c=g[0].checked,b=aq.cache[k.key],h=g.parents("tr").eq(0).data("index");layui.each(b,function(i,a){h===i?a.LAY_CHECKED=!0:delete a.LAY_CHECKED}),k.setThisRowChecked(h),layui.event.call(this,V,"radio("+d+")",x.call(this,{checked:c}))}),k.layBody.on("mouseenter","tr",function(){var c=ab(this),b=c.index();c.data("off")||k.layBody.find("tr:eq("+b+")").addClass(q)}).on("mouseleave","tr",function(){var c=ab(this),b=c.index();c.data("off")||k.layBody.find("tr:eq("+b+")").removeClass(q)}).on("click","tr",function(){j.call(this,"row")}).on("dblclick","tr",function(){j.call(this,"rowDouble")});var j=function(b){var a=ab(this);a.data("off")||layui.event.call(this,V,b+"("+d+")",x.call(a.children("td")[0]))};k.layBody.on("change","."+G,function(){var g=ab(this),c=this.value,b=g.parent().data("field"),i=g.parents("tr").eq(0).data("index"),h=aq.cache[k.key][i];h[b]=c,layui.event.call(this,V,"edit("+d+")",x.call(this,{value:c,field:b}))}).on("blur","."+G,function(){var h,c=ab(this),b=this,m=c.parent().data("field"),i=c.parents("tr").eq(0).data("index"),g=aq.cache[k.key][i];k.eachCols(function(e,a){a.field==m&&a.templet&&(h=a.templet)}),c.siblings(l).html(function(a){return aa({templet:h},a,g)}(b.value)),c.parent().data("content",b.value),c.remove()}),k.layBody.on("click","td",function(h){var g=ab(this),c=(g.data("field"),g.data("edit")),b=g.children(l);if(!g.data("off")&&c){var m=ab('<input class="layui-input '+G+'">');return m[0].value=g.data("content")||b.text(),g.find("."+G)[0]||g.append(m),m.focus(),void layui.stope(h)}}).on("mouseenter","td",function(){u.call(this)}).on("mouseleave","td",function(){u.call(this,"hide")});var n="layui-table-grid-down",u=function(g){var c=ab(this),b=c.children(l);if(!c.data("off")){if(g){c.find(".layui-table-grid-down").remove()}else{if(b.prop("scrollWidth")>b.outerWidth()){if(b.find("."+n)[0]){return}c.append('<div class="'+n+'"><i class="layui-icon layui-icon-down"></i></div>')}}}};k.layBody.on("click","."+n,function(a){var g=ab(this),c=g.parent(),b=c.children(l);k.tipsIndex=ai.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(b.height()+16)+"px;"+function(){return"sm"===w.size?"padding: 4px 15px; font-size: 12px;":"lg"===w.size?"padding: 14px 15px;":""}()+'">',b.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),b[0],{tips:[3,""],time:-1,anim:-1,maxWidth:ad.ios||ad.android?300:k.elem.width()/2,isOutAnim:!1,skin:"layui-table-tips",success:function(i,h){i.find(".layui-table-tips-c").on("click",function(){ai.close(h)})}}),layui.stope(a)}),k.layBody.on("click","*[lay-event]",function(){var c=ab(this),b=c.parents("tr").eq(0).data("index");layui.event.call(this,V,"tool("+d+")",x.call(this,{event:c.attr("lay-event")})),k.setThisRowChecked(b)}),k.layMain.on("scroll",function(){var c=ab(this),b=c.scrollLeft(),g=c.scrollTop();k.layHeader.scrollLeft(b),k.layTotal.scrollLeft(b),k.layFixed.find(aj).scrollTop(g),ai.close(k.tipsIndex)}),K.on("resize",function(){k.resize()})},function(){ak.on("click",function(){ak.trigger("table.remove.tool.panel")}),ak.on("table.remove.tool.panel",function(){ab(".layui-table-tool-panel").remove()})}(),aq.init=function(f,d){d=d||{};var c=this,b=ab(f?'table[lay-filter="'+f+'"]':am+"[lay-data]"),g="Table element property lay-data configuration item has a syntax error: ";return b.each(function(){var h=ab(this),e=h.attr("lay-data");try{e=new Function("return "+e)()}catch(j){af.error(g+e)}var k=[],i=ab.extend({elem:this,cols:[],data:[],skin:h.attr("lay-skin"),size:h.attr("lay-size"),even:"string"==typeof h.attr("lay-even")},aq.config,d,e);f&&h.hide(),h.find("thead>tr").each(function(a){i.cols[a]=[],ab(this).children().each(function(o){var n=ab(this),m=n.attr("lay-data");try{m=new Function("return "+m)()}catch(p){return af.error(g+m)}var s=ab.extend({title:n.text(),colspan:n.attr("colspan")||0,rowspan:n.attr("rowspan")||0},m);s.colspan<2&&k.push(s),i.cols[a].push(s)})}),h.find("tbody>tr").each(function(n){var m=ab(this),l={};m.children("td").each(function(p,o){var a=ab(this),r=a.data("field");if(r){return l[r]=a.html()}}),layui.each(k,function(p,o){var a=m.children("td").eq(p);l[o.field]=a.html()}),i.data[n]=l}),aq.render(i)}),c},ar.that={},ar.config={},aq.eachCols=function(g,d,c){var b=ar.config[g]||{},j=[],h=0;c=ab.extend(!0,[],c||b.cols),layui.each(c,function(i,a){layui.each(a,function(m,k){if(k.colGroup){var e=0;h++,k.CHILD_COLS=[],layui.each(c[i+1],function(n,l){l.PARENT_COL_INDEX||e>1&&e==k.colspan||(l.PARENT_COL_INDEX=h,k.CHILD_COLS.push(l),e+=parseInt(l.colspan>1?l.colspan:1))})}k.PARENT_COL_INDEX||j.push(k)})});var f=function(a){layui.each(a||j,function(k,i){return i.CHILD_COLS?f(i.CHILD_COLS):void ("function"==typeof d&&d(k,i))})};f()},aq.checkStatus=function(g){var f=0,d=0,c=[],b=aq.cache[g]||[];return layui.each(b,function(h,a){return a.constructor===Array?void d++:void (a[aq.config.checkName]&&(f++,c.push(aq.clearCacheKey(a))))}),{data:c,isAll:!!b.length&&f===b.length-d}},aq.exportFile=function(h,f,d){var c=this;f=f||aq.clearCacheKey(aq.cache[h]),d=d||"csv";var b=ar.config[h]||{},j={csv:"text/csv",xls:"application/vnd.ms-excel"}[d],g=document.createElement("a");return ad.ie?af.error("IE_NOT_SUPPORT_EXPORTS"):(g.href="data:"+j+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var e=[],a=[],k=[];return layui.each(f,function(l,i){var m=[];"object"==typeof h?(layui.each(h,function(o,n){0==l&&e.push(n||"")}),layui.each(aq.clearCacheKey(i),function(o,n){m.push('"'+(n||"")+'"')})):aq.eachCols(h,function(p,n){if(n.field&&"normal"==n.type&&!n.hide){var r=i[n.field];void 0!==r&&null!==r||(r=""),0==l&&e.push(n.title||""),m.push('"'+aa(n,r,i,"text")+'"')}}),a.push(m.join(","))}),layui.each(c.dataTotal,function(l,i){k.push(i)}),e.join(",")+"\r\n"+a.join("\r\n")+"\r\n"+k.join(",")}()),g.download=(b.title||"table_"+(b.index||""))+"."+d,document.body.appendChild(g),g.click(),void document.body.removeChild(g))},aq.resize=function(b){if(b){var a=ac(b);if(!a){return}ar.that[b].resize()}else{layui.each(ar.that,function(){this.resize()})}},aq.reload=function(f,d){var c=ac(f);if(c){var b=ar.that[f];return b.reload(d),ar.call(b)}},aq.render=function(b){var a=new M(b);return ar.call(a)},aq.clearCacheKey=function(a){return a=ab.extend({},a),delete a[aq.config.checkName],delete a[aq.config.indexName],a},aq.init(),ap(V,aq)});